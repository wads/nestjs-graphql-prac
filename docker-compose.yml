version: '3.8'

services:
  edu-backend:
    build:
      context: .
      target: development
      dockerfile: ./Dockerfile
    command: npm run start:debug
    ports:
      - 3000:3000
      - 9229:9229
    volumes:
      - .:/usr/src/app
    restart: unless-stopped
    tty: true
    depends_on:
      - edu-db
#  prod:
#    container_name: edu_backend_prod
#    build:
#      context: .
#      target: production
#      dockerfile: ./Dockerfile
#    command: npm run start:prod
#    ports:
#      - 3000:3000
#      - 9229:9229
#    volumes:
#      - .:/usr/src/app
#    restart: unless-stopped
#    tty: true
  edu-db:
    image: mysql:8.0
    platform: linux/x86_64
    environment:
      MYSQL_ROOT_PASSWORD: password
      MYSQL_DATABASE: edu
      MYSQL_USER: edu_user
      MYSQL_PASSWORD: password
    ports:
      - 3306:3306
    restart: always
    volumes:
      - ./conf/my.cnf:/etc/mysql/conf.d/my.cnf
